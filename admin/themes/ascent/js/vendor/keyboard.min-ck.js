(function(e,t){function n(){function e(){var n;n=t("amd");n.fork=e;return n}return e()}function r(){function n(){function r(){var t,n,r;r=Array.prototype.slice.apply(arguments);for(n=0;n<s.length;n+=1)typeof o[s[n]]=="undefined"?delete e[s[n]]:e[s[n]]=o[s[n]];o={};for(n=0;n<r.length;n+=1){if(typeof r[n]!="string")throw new Error("Cannot replace namespaces. All new namespaces must be strings.");o[r[n]]=e[r[n]];e[r[n]]=i}s=r;return s}var i,s=[],o={};i=t("global");i.fork=n;i.noConflict=r;return i}var r;r=n();r.noConflict("KeyboardJS","k")}[].indexOf||(Array.prototype.indexOf=function(e,t,n){for(n=this.length,t=(n+~~t)%n;t<n&&(!(t in this)||this[t]!==e);t++);return t^n?t:-1});typeof define=="function"&&define.amd?define(n):r()})(this,function(e){function t(){if(window.addEventListener){document.addEventListener("keydown",i,!1);document.addEventListener("keyup",s,!1);window.addEventListener("blur",r,!1);window.addEventListener("webkitfullscreenchange",r,!1);window.addEventListener("mozfullscreenchange",r,!1)}else if(window.attachEvent){document.attachEvent("onkeydown",i);document.attachEvent("onkeyup",s);window.attachEvent("onblur",r)}}function n(){r();if(window.removeEventListener){document.removeEventListener("keydown",i,!1);document.removeEventListener("keyup",s,!1);window.removeEventListener("blur",r,!1);window.removeEventListener("webkitfullscreenchange",r,!1);window.removeEventListener("mozfullscreenchange",r,!1)}else if(window.detachEvent){document.detachEvent("onkeydown",i);document.detachEvent("onkeyup",s);window.detachEvent("onblur",r)}}function r(e){_=[];c();m(e)}function i(e){var t,n;t=o(e.keyCode);if(t.length<1)return;for(n=0;n<t.length;n+=1)x(t[n]);l();v(e)}function s(e){var t,n;t=o(e.keyCode);if(t.length<1)return;for(n=0;n<t.length;n+=1)T(t[n]);c();m(e)}function o(e){return O[e]||[]}function u(e){var t;for(t in O){if(!O.hasOwnProperty(t))continue;if(O[t].indexOf(e)>-1)return t}return!1}function a(e,t){if(typeof e!="string"&&(typeof e!="object"||typeof e.push!="function"))throw new Error("Cannot create macro. The combo must be a string or array.");if(typeof t!="object"||typeof t.push!="function")throw new Error("Cannot create macro. The injectedKeys must be an array.");M.push([e,t])}function f(e){var t;if(typeof e!="string"&&(typeof e!="object"||typeof e.push!="function"))throw new Error("Cannot remove macro. The combo must be a string or array.");for(mI=0;mI<M.length;mI+=1){t=M[mI];if(g(e,t[0])){T(t[1]);M.splice(mI,1);break}}}function l(){var e,t,n;for(e=0;e<M.length;e+=1){t=w(M[e][0]);if(H.indexOf(M[e])===-1&&y(t)){H.push(M[e]);for(n=0;n<M[e][1].length;n+=1)x(M[e][1][n])}}}function c(){var e,t,n;for(e=0;e<H.length;e+=1){t=w(H[e][0]);if(y(t)===!1){for(n=0;n<H[e][1].length;n+=1)T(H[e][1][n]);H.splice(e,1);e-=1}}}function h(e,t,n){function r(){var e;for(e=0;e<u.length;e+=1)D.splice(D.indexOf(u[e]),1)}function i(e){function t(){var t,n;for(t=0;t<r.length;t+=1)if(typeof r[t]=="function")if(e==="keyup")for(n=0;n<u.length;n+=1)u[n].keyUpCallback.splice(u[n].keyUpCallback.indexOf(r[t]),1);else for(n=0;n<u.length;n+=1)u[n].keyDownCallback.splice(u[n].keyDownCallback.indexOf(r[t]),1)}var n={},r,i,s;if(typeof e!="string")throw new Error("Cannot bind callback. The event name must be a string.");if(e!=="keyup"&&e!=="keydown")throw new Error('Cannot bind callback. The event name must be a "keyup" or "keydown".');r=Array.prototype.slice.apply(arguments,[1]);for(i=0;i<r.length;i+=1)if(typeof r[i]=="function")if(e==="keyup")for(s=0;s<u.length;s+=1)u[s].keyUpCallback.push(r[i]);else if(e==="keydown")for(s=0;s<u.length;s+=1)u[s].keyDownCallback.push(r[i]);n.clear=t;return n}var s={},o,u=[],a={},f,l;typeof e=="string"&&(e=w(e));for(f=0;f<e.length;f+=1){o={};l=E([e[f]]);if(typeof l!="string")throw new Error("Failed to bind key combo. The key combo must be string.");o.keyCombo=l;o.keyDownCallback=[];o.keyUpCallback=[];t&&o.keyDownCallback.push(t);n&&o.keyUpCallback.push(n);D.push(o);u.push(o)}s.clear=r;s.on=i;return s}function p(e){var t,n,r;for(t=0;t<D.length;t+=1){n=D[t];if(g(e,n.keyCombo)){D.splice(t,1);t-=1}}}function d(e){var t,n,r;if(e)for(t=0;t<D.length;t+=1){r=D[t];for(n=0;n<r.keyCombo.length;n+=1)if(r.keyCombo[n].indexOf(e)>-1){D.splice(t,1);t-=1;break}}else D=[]}function v(e){var t,n,r,i,s,o,u,a,f,l,c=[],h;s=[].concat(_);for(t=0;t<D.length;t+=1){h=b(D[t].keyCombo).length;c[h]||(c[h]=[]);c[h].push(D[t])}for(n=c.length-1;n>=0;n-=1){if(!c[n])continue;for(t=0;t<c[n].length;t+=1){r=c[n][t];i=b(r.keyCombo);f=!0;for(a=0;a<i.length;a+=1)if(s.indexOf(i[a])===-1){f=!1;break}if(f&&y(r.keyCombo)){P.push(r);for(a=0;a<i.length;a+=1){l=s.indexOf(i[a]);if(l>-1){s.splice(l,1);a-=1}}for(o=0;o<r.keyDownCallback.length;o+=1)r.keyDownCallback[o](e,S(),r.keyCombo)===!1&&(u=!0);if(u===!0){e.preventDefault();e.stopPropagation()}}}}}function m(e){var t,n,r,i;for(t=0;t<P.length;t+=1){r=P[t];if(y(r.keyCombo)===!1){for(n=0;n<r.keyUpCallback.length;n+=1)r.keyUpCallback[n](e,S(),r.keyCombo)===!1&&(i=!0);if(i===!0){e.preventDefault();e.stopPropagation()}P.splice(t,1);t-=1}}}function g(e,t){var n,r,i;e=w(e);t=w(t);if(e.length!==t.length)return!1;for(n=0;n<e.length;n+=1){if(e[n].length!==t[n].length)return!1;for(r=0;r<e[n].length;r+=1){if(e[n][r].length!==t[n][r].length)return!1;for(i=0;i<e[n][r].length;i+=1)if(t[n][r].indexOf(e[n][r][i])===-1)return!1}}return!0}function y(e){var t,n,r,i,s=0,o,u;e=w(e);for(t=0;t<e.length;t+=1){u=!0;s=0;for(n=0;n<e[t].length;n+=1){r=[].concat(e[t][n]);for(i=s;i<_.length;i+=1){o=r.indexOf(_[i]);if(o>-1){r.splice(o,1);s=i}}if(r.length!==0){u=!1;break}}if(u)return!0}return!1}function b(e){var t,n,r,i=[];e=w(e);for(t=0;t<e.length;t+=1)for(n=0;n<e[t].length;n+=1)i=i.concat(e[t][n]);return i}function w(e){var t=e,n=0,r=0,i=!1,s=!1,o=[],u=[],a=[],f="";if(typeof e=="object"&&typeof e.push=="function")return e;if(typeof e!="string")throw new Error('Cannot parse "keyCombo" because its type is "'+typeof e+'". It must be a "string".');while(t.charAt(n)===" ")n+=1;for(;;){if(t.charAt(n)===" "){while(t.charAt(n)===" ")n+=1;i=!0}else if(t.charAt(n)===","){if(r||s)throw new Error("Failed to parse key combo. Unexpected , at character index "+n+".");s=!0;n+=1}else if(t.charAt(n)==="+"){if(f.length){a.push(f);f=""}if(r||s)throw new Error("Failed to parse key combo. Unexpected + at character index "+n+".");r=!0;n+=1}else if(t.charAt(n)===">"){if(f.length){a.push(f);f=""}if(a.length){u.push(a);a=[]}if(r||s)throw new Error("Failed to parse key combo. Unexpected > at character index "+n+".");r=!0;n+=1}else if(n<t.length-1&&t.charAt(n)==="!"&&(t.charAt(n+1)===">"||t.charAt(n+1)===","||t.charAt(n+1)==="+")){f+=t.charAt(n+1);r=!1;i=!1;s=!1;n+=2}else{if(!(n<t.length&&t.charAt(n)!=="+"&&t.charAt(n)!==">"&&t.charAt(n)!==","&&t.charAt(n)!==" ")){n+=1;continue}if(r===!1&&i===!0||s===!0){if(f.length){a.push(f);f=""}if(a.length){u.push(a);a=[]}if(u.length){o.push(u);u=[]}}r=!1;i=!1;s=!1;while(n<t.length&&t.charAt(n)!=="+"&&t.charAt(n)!==">"&&t.charAt(n)!==","&&t.charAt(n)!==" "){f+=t.charAt(n);n+=1}}if(n>=t.length){if(f.length){a.push(f);f=""}if(a.length){u.push(a);a=[]}if(u.length){o.push(u);u=[]}break}}return o}function E(e){var t,n,r=[];if(typeof e=="string")return e;if(typeof e!="object"||typeof e.push!="function")throw new Error("Cannot stringify key combo.");for(t=0;t<e.length;t+=1){r[t]=[];for(n=0;n<e[t].length;n+=1)r[t][n]=e[t][n].join(" + ");r[t]=r[t].join(" > ")}return r.join(" ")}function S(){return[].concat(_)}function x(e){if(e.match(/\s/))throw new Error("Cannot add key name "+e+" to active keys because it contains whitespace.");if(_.indexOf(e)>-1)return;_.push(e)}function T(e){var t=u(e);t==="91"||t==="92"?_=[]:_.splice(_.indexOf(e),1)}function N(e,t){if(typeof e!="string")throw new Error("Cannot register new locale. The locale name must be a string.");if(typeof t!="object")throw new Error("Cannot register "+e+" locale. The locale map must be an object.");if(typeof t.map!="object")throw new Error("Cannot register "+e+" locale. The locale map is invalid.");t.macros||(t.macros=[]);L[e]=t}function C(e){if(e){if(typeof e!="string")throw new Error("Cannot set locale. The locale name must be a string.");if(!L[e])throw new Error("Cannot set locale to "+e+" because it does not exist. If you would like to submit a "+e+" locale map for KeyboardJS please submit it at https://github.com/RobertWHurst/KeyboardJS/issues.");O=L[e].map;M=L[e].macros;A=e}return A}var k={},L={},A,O,M,_=[],D=[],P=[],H=[],B,j;j={map:{3:["cancel"],8:["backspace"],9:["tab"],12:["clear"],13:["enter"],16:["shift"],17:["ctrl"],18:["alt","menu"],19:["pause","break"],20:["capslock"],27:["escape","esc"],32:["space","spacebar"],33:["pageup"],34:["pagedown"],35:["end"],36:["home"],37:["left"],38:["up"],39:["right"],40:["down"],41:["select"],42:["printscreen"],43:["execute"],44:["snapshot"],45:["insert","ins"],46:["delete","del"],47:["help"],91:["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"],92:["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"],145:["scrolllock","scroll"],186:["semicolon",";"],187:["equal","equalsign","="],188:["comma",","],189:["dash","-"],190:["period","."],191:["slash","forwardslash","/"],192:["graveaccent","`"],219:["openbracket","["],220:["backslash","\\"],221:["closebracket","]"],222:["apostrophe","'"],48:["zero","0"],49:["one","1"],50:["two","2"],51:["three","3"],52:["four","4"],53:["five","5"],54:["six","6"],55:["seven","7"],56:["eight","8"],57:["nine","9"],96:["numzero","num0"],97:["numone","num1"],98:["numtwo","num2"],99:["numthree","num3"],100:["numfour","num4"],101:["numfive","num5"],102:["numsix","num6"],103:["numseven","num7"],104:["numeight","num8"],105:["numnine","num9"],106:["nummultiply","num*"],107:["numadd","num+"],108:["numenter"],109:["numsubtract","num-"],110:["numdecimal","num."],111:["numdevide","num/"],144:["numlock","num"],112:["f1"],113:["f2"],114:["f3"],115:["f4"],116:["f5"],117:["f6"],118:["f7"],119:["f8"],120:["f9"],121:["f10"],122:["f11"],123:["f12"]},macros:[["shift + `",["tilde","~"]],["shift + 1",["exclamation","exclamationpoint","!"]],["shift + 2",["at","@"]],["shift + 3",["number","#"]],["shift + 4",["dollar","dollars","dollarsign","$"]],["shift + 5",["percent","%"]],["shift + 6",["caret","^"]],["shift + 7",["ampersand","and","&"]],["shift + 8",["asterisk","*"]],["shift + 9",["openparen","("]],["shift + 0",["closeparen",")"]],["shift + -",["underscore","_"]],["shift + =",["plus","+"]],["shift + (",["opencurlybrace","opencurlybracket","{"]],["shift + )",["closecurlybrace","closecurlybracket","}"]],["shift + \\",["verticalbar","|"]],["shift + ;",["colon",":"]],["shift + '",["quotationmark",'"']],["shift + !,",["openanglebracket","<"]],["shift + .",["closeanglebracket",">"]],["shift + /",["questionmark","?"]]]};for(B=65;B<=90;B+=1){j.map[B]=String.fromCharCode(B+32);j.macros.push(["shift + "+String.fromCharCode(B+32)+", capslock + "+String.fromCharCode(B+32),[String.fromCharCode(B)]])}N("us",j);C("us");t();k.enable=t;k.disable=n;k.activeKeys=S;k.on=h;k.clear=p;k.clear.key=d;k.locale=C;k.locale.register=N;k.macro=a;k.macro.remove=f;k.key={};k.key.name=o;k.key.code=u;k.combo={};k.combo.active=y;k.combo.parse=w;k.combo.stringify=E;return k});